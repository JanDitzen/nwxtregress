mata:
	e= I(10)
	e[1,2] = 0.75 * 3
	e[2,1] = 0.75 * 3
	lud(e,L=0,U=0,p=0)
	L
	U
	p
	L+U-I(rows(e))


end

/* Result in mata:


:         L+U-I(rows(e))
                  1             2             3             4             5             6             7             8             9            10
     +---------------------------------------------------------------------------------------------------------------------------------------------+
   1 |         2.25             1             0             0             0             0             0             0             0             0  |
   2 |  .4444444444   1.805555556             0             0             0             0             0             0             0             0  |
   3 |            0             0             1             0             0             0             0             0             0             0  |
   4 |            0             0             0             1             0             0             0             0             0             0  |
   5 |            0             0             0             0             1             0             0             0             0             0  |
   6 |            0             0             0             0             0             1             0             0             0             0  |
   7 |            0             0             0             0             0             0             1             0             0             0  |
   8 |            0             0             0             0             0             0             0             1             0             0  |
   9 |            0             0             0             0             0             0             0             0             1             0  |
  10 |            0             0             0             0             0             0             0             0             0             1  |
     +---------------------------------------------------------------------------------------------------------------------------------------------+

*/


/// L, U and L+U-I() are different between stata and matlab
/// if 0.75 * 3 is replaced with 0.75 * 2, then results match

/*
e = speye(10);
e(1,2) = 0.75 * 3;
e(2,1) = 0.75 * 3;
e
c = ilu(e);
[L,U] = ilu(e);
L
U
%L+U-speye same as c
L+U-speye(length(e))
c
*/

/*
matlab results:
   (1,1)       1.0000
   (2,1)       2.2500
   (1,2)       2.2500
   (2,2)      -4.0625
   (3,3)       1.0000
   (4,4)       1.0000
   (5,5)       1.0000
   (6,6)       1.0000
   (7,7)       1.0000
   (8,8)       1.0000
   (9,9)       1.0000
  (10,10)      1.0000
  */
